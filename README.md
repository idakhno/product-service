# Product API

RESTful API сервис для управления пользователями, продуктами и заказами.

## Основные технологии

- **Go 1.24**
- **PostgreSQL** в качестве базы данных
- **Chi** как HTTP-роутер
- **Docker & Docker Compose** для контейнеризации
- **OpenTelemetry** для трассировки и **Sentry** для сбора ошибок
- **Swagger** для документации API

## Быстрый старт

**1. Подготовка**

Убедитесь, что у вас установлены **Docker**, **Docker Compose** и **Make**.

**2. Настройка окружения**

В корне проекта находится файл `.env`. В нем уже есть все необходимые переменные окружения для локального запуска.

**3. Запуск**

Выполните одну команду:

```sh
make up
```

Она соберет и запустит Docker-контейнеры с приложением и базой данных. API будет доступен по адресу `http://localhost:8080`.

**4. Применение миграций**

После первого запуска база данных будет пустой. Чтобы создать необходимые таблицы, выполните:

```sh
make migrate-up
```

## Документация API и использование

API задокументировано с помощью Swagger. Документация доступна по адресу:
[http://localhost:8080/swagger/index.html](http://localhost:8080/swagger/index.html)

### Пример запроса (PowerShell)

Для отправки сложных JSON-запросов в PowerShell рекомендуется использовать следующий синтаксис, чтобы избежать проблем с экранированием:

```powershell
# Регистрация пользователя
curl.exe -X POST http://localhost:8080/users/register -H "Content-Type: application/json" -d '{\"email\": \"test@example.com\", \"password\": \"password123\", \"firstname\": \"John\", \"lastname\": \"Doe\", \"age\": 30, \"is_married\": false}'
```

## Основные команды `make`

- `make up`: Собрать и запустить все сервисы.
- `make down`: Остановить и удалить все сервисы.
- `make logs`: Посмотреть логи приложения.
- `make migrate-up`: Применить миграции к базе данных.
- `make test`: Запустить интеграционные тесты (требует запущенной БД).
- `make swagger`: Перегенерировать Swagger-документацию.
- `make lint`: Запустить проверку кода линтером. 